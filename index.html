<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="utf-8"/>
  <title>Simple Harmonic Motion Calculator (‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß - ‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤ + ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Å‡∏î‡πÑ‡∏î‡πâ)</title>
  <style>
    body { font-family: Arial, Helvetica, sans-serif; margin: 18px; background: #f7f9fb; color: #111; }
    h1 { margin-bottom: 6px; }
    .box { background: white; padding: 12px; border-radius: 8px; box-shadow: 0 1px 4px rgba(0,0,0,0.08); margin-bottom: 14px; }
    h3 { margin-top: 0; }
    label { display: inline-block; width: 160px; font-weight: bold; font-size: 0.9em; }
    input[type="text"] { width: 80px; padding: 4px; border: 1px solid #ddd; border-radius: 4px; margin-right: 4px; }
    button { padding: 8px 12px; margin: 4px; background: #1677ff; color: white; border: none; border-radius: 6px; cursor: pointer; }
    button:hover { background: #0d5eff; }
    .state-row { margin-bottom: 16px; padding: 12px; border: 1px solid #e6eef6; border-radius: 6px; background: #f9fcff; }
    .vars-container { display: flex; flex-wrap: wrap; gap: 8px; }
    .var-group { display: inline-block; margin: 4px 6px; vertical-align: top; min-width: 170px; }
    .warning { color: #b91c1c; font-weight: 700; }
    table { width: 100%; border-collapse: collapse; margin-top: 8px; }
    td, th { border: 1px solid #e6eef6; padding: 8px; text-align: center; }
    th { background: #f0f8ff; }
    #result { display: none; }
    select { width: 300px; padding: 5px; }
    .hidden { display: none !important; }
    #helpModal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 25px;
      border: 1px solid #ccc;
      box-shadow: 0 4px 20px rgba(0,0,0,0.2);
      z-index: 1000;
      max-height: 90vh;
      max-width: 90vw;
      overflow: auto;
      border-radius: 10px;
    }
    .ratio-table th { background: #fff3cd; }
    pre { background: #f8f8f8; padding: 12px; border-radius: 6px; white-space: pre-wrap; }
  </style>
</head>
<body>
  <h1>üìò Simple Harmonic Calculator (‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß - ‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤ + ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Å‡∏î‡πÑ‡∏î‡πâ)</h1>

  <div class="box">
    <button onclick="showHelp()">üìñ ‡∏î‡∏π‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</button>
    <button onclick="clearAll()">üßπ ‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
  </div>

  <div class="box">
    <h3>üìù ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
    <div>
      <label>‡∏£‡∏∞‡∏ö‡∏ö:</label>
      <select id="system" onchange="updateVisibility()">
        <option value="spring">‡∏™‡∏õ‡∏£‡∏¥‡∏á (Spring)</option>
        <option value="pendulum">‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏° (Pendulum)</option>
      </select>
      &nbsp;&nbsp;
      <label>‡πÇ‡∏´‡∏°‡∏î:</label>
      <select id="mode" onchange="updateMode()">
        <option value="single">‡∏™‡∏†‡∏≤‡∏ß‡∏∞‡πÄ‡∏î‡∏µ‡∏¢‡∏ß (Single State)</option>
        <option value="multi">‡∏´‡∏•‡∏≤‡∏¢‡∏™‡∏†‡∏≤‡∏ß‡∏∞ (‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô)</option>
      </select>
    </div>

    <div id="stateContainer"></div>

    <br><br>
    <button onclick="calculate()" style="padding: 10px 30px; font-size: 1.1em;">‚öôÔ∏è ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏ô‡∏µ‡πâ</button>
  </div>

  <div id="result" class="box"></div>

  <div id="helpModal">
    <h2>üìò ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÄ‡∏ï‡πá‡∏° ‡πÜ</h2>
    <p>‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏†‡∏≤‡∏ß‡∏∞‡πÄ‡∏î‡∏µ‡∏¢‡∏ß ‚Üí ‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡∏ï‡∏≤‡∏°‡∏õ‡∏Å‡∏ï‡∏¥<br>
    ‡πÇ‡∏´‡∏°‡∏î‡∏´‡∏•‡∏≤‡∏¢‡∏™‡∏†‡∏≤‡∏ß‡∏∞ ‚Üí ‡∏à‡∏∞‡πÇ‡∏ä‡∏ß‡πå 2 ‡∏™‡∏†‡∏≤‡∏ß‡∏∞<br>
    ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏à‡∏∞‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Ç‡∏≤‡∏î‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏™‡∏†‡∏≤‡∏ß‡∏∞<br>
    ‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô (state2 / state1) ‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß + ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏§‡∏©‡∏é‡∏µ‡∏à‡∏≤‡∏Å m,k,L,g</p>
    <button onclick="closeHelp()">‡∏õ‡∏¥‡∏î</button>
  </div>

  <script>
    // ====================== ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ======================
    const varLabels = {
      m: '‡∏°‡∏ß‡∏• m (kg)',
      k: '‡∏™‡∏õ‡∏£‡∏¥‡∏á k (N/m)',
      L: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß L (m)',
      g: '‡πÅ‡∏£‡∏á‡πÇ‡∏ô‡πâ‡∏°‡∏ñ‡πà‡∏ß‡∏á g (m/s¬≤)',
      sigmaF: '‡πÅ‡∏£‡∏á‡∏î‡∏∂‡∏á‡∏Å‡∏•‡∏±‡∏ö F (N)',
      x: '‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏±‡∏î x (m)',
      v: '‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß v (m/s)',
      a: '‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πà‡∏á a (m/s¬≤)',
      A: '‡πÅ‡∏≠‡∏°‡∏û‡∏•‡∏¥‡∏à‡∏π‡∏î A (m)',
      Vmax: '‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πá‡∏ß‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î Vmax (m/s)',
      a_max: '‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏£‡πà‡∏á‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î a_max (m/s¬≤)',
      KE: '‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏à‡∏•‡∏ô‡πå KE (J)',
      PE: '‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏®‡∏±‡∏Å‡∏¢‡πå PE (J)',
      E: '‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô‡∏£‡∏ß‡∏° E (J)',
      omega: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà‡πÄ‡∏ä‡∏¥‡∏á‡∏°‡∏∏‡∏° œâ (rad/s)',
      f: '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡∏µ‡πà f (Hz)',
      T: '‡∏Ñ‡∏≤‡∏ö T (s)',
      t: '‡πÄ‡∏ß‡∏•‡∏≤ t (s)',
      phi: '‡πÄ‡∏ü‡∏™‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô œÜ (rad)',
      Phi: '‡πÄ‡∏ü‡∏™‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î Œ¶ (rad)'
    };

    const allVars = Object.keys(varLabels);

    // ====================== ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤ ======================
    function createStateRow(stateNum) {
      const div = document.createElement('div');
      div.className = 'state-row';
      div.innerHTML = `<h4 style="color:#1677ff;">‡∏™‡∏†‡∏≤‡∏ß‡∏∞‡∏ó‡∏µ‡πà ${stateNum}</h4><div class="vars-container"></div>`;
      const container = div.querySelector('.vars-container');

      allVars.forEach(key => {
        const group = document.createElement('div');
        group.className = 'var-group';

        const label = document.createElement('label');
        label.textContent = varLabels[key];

        const input = document.createElement('input');
        input.type = 'text';
        input.id = `state${stateNum}_${key}`;
        input.placeholder = '0';  // ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏á‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏™‡πà

        group.appendChild(label);
        group.appendChild(input);
        container.appendChild(group);
      });

      return div;
    }

    // ====================== ‡∏™‡∏•‡∏±‡∏ö‡πÇ‡∏´‡∏°‡∏î ======================
    function updateMode() {
      const mode = document.getElementById('mode').value;
      const container = document.getElementById('stateContainer');
      container.innerHTML = '';
      const numStates = mode === 'single' ? 1 : 2;

      for (let i = 1; i <= numStates; i++) {
        container.appendChild(createStateRow(i));
      }

      updateVisibility();
    }

    // ====================== ‡∏ã‡πà‡∏≠‡∏ô k ‡∏´‡∏£‡∏∑‡∏≠ L ======================
    function updateVisibility() {
      const system = document.getElementById('system').value;
      const isSpring = system === 'spring';

      document.querySelectorAll('.var-group').forEach(group => {
        const input = group.querySelector('input');
        if (!input) return;
        const key = input.id.split('_')[1]; // ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ‡πÉ‡∏´‡πâ‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á ‡πÑ‡∏°‡πà‡∏°‡∏µ typo
        if ((key === 'k' && !isSpring) || (key === 'L' && isSpring)) {
          group.classList.add('hidden');
        } else {
          group.classList.remove('hidden');
        }
      });
    }

    // ====================== ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏´‡∏•‡∏±‡∏Å (‡∏¢‡∏≤‡∏ß‡πÄ‡∏ï‡πá‡∏°) ======================
    function calculateState(inputs, system) {
      let result = { ...inputs };
      let explanation = '';

      // ‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
      if (system === 'pendulum' && !result.g) {
        result.g = 9.81;
        explanation += `‡πÉ‡∏ä‡πâ g = 9.81 m/s¬≤ (‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô)\n`;
      }
      if (result.t !== undefined && result.phi === undefined) {
        result.phi = 0;
        explanation += `‡∏™‡∏°‡∏°‡∏ï‡∏¥ œÜ = 0 rad (‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏à‡∏≤‡∏Å‡∏à‡∏∏‡∏î‡∏™‡∏°‡∏î‡∏∏‡∏•)\n`;
      }

      let changed = true;
      let iterations = 0;
      while (changed && iterations < 30) {
        changed = false;
        iterations++;

        // ---------- ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏±‡∏°‡∏û‡∏±‡∏ô‡∏ò‡πå‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô T ‚Üî f ‚Üî œâ ----------
        if ('f' in result && !('T' in result)) { result.T = 1 / result.f; explanation += `T = 1/f = ${result.T.toFixed(6)} s\n`; changed = true; }
        if ('T' in result && !('f' in result)) { result.f = 1 / result.T; explanation += `f = 1/T = ${result.f.toFixed(6)} Hz\n`; changed = true; }
        if ('omega' in result && !('T' in result)) { result.T = 2 * Math.PI / result.omega; explanation += `T = 2œÄ/œâ = ${result.T.toFixed(6)} s\n`; changed = true; }
        if ('T' in result && !('omega' in result)) { result.omega = 2 * Math.PI / result.T; explanation += `œâ = 2œÄ/T = ${result.omega.toFixed(6)} rad/s\n`; changed = true; }
        if ('f' in result && !('omega' in result)) { result.omega = 2 * Math.PI * result.f; explanation += `œâ = 2œÄf = ${result.omega.toFixed(6)} rad/s\n`; changed = true; }
        if ('omega' in result && !('f' in result)) { result.f = result.omega / (2 * Math.PI); explanation += `f = œâ/(2œÄ) = ${result.f.toFixed(6)} Hz\n`; changed = true; }

        // ---------- ‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏õ‡∏£‡∏¥‡∏á ----------
        if (system === 'spring') {
          if ('k' in result && 'm' in result && !('omega' in result)) { result.omega = Math.sqrt(result.k / result.m); explanation += `œâ = ‚àö(k/m) = ${result.omega.toFixed(6)} rad/s\n`; changed = true; }
          if ('omega' in result && 'm' in result && !('k' in result)) { result.k = result.m * result.omega**2; explanation += `k = m œâ¬≤ = ${result.k.toFixed(6)} N/m\n`; changed = true; }
          if ('omega' in result && 'k' in result && !('m' in result)) { result.m = result.k / result.omega**2; explanation += `m = k / œâ¬≤ = ${result.m.toFixed(6)} kg\n`; changed = true; }
          if ('k' in result && 'x' in result && !('PE' in result)) { result.PE = 0.5 * result.k * result.x**2; explanation += `PE = ¬Ω k x¬≤ = ${result.PE.toFixed(6)} J\n`; changed = true; }
          if ('k' in result && 'x' in result && !('sigmaF' in result)) { result.sigmaF = -result.k * result.x; explanation += `F = -k x = ${result.sigmaF.toFixed(6)} N\n`; changed = true; }
        }
        // ---------- ‡∏£‡∏∞‡∏ö‡∏ö‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏° ----------
        else {
          if ('L' in result && 'g' in result && !('omega' in result)) { result.omega = Math.sqrt(result.g / result.L); explanation += `œâ = ‚àö(g/L) = ${result.omega.toFixed(6)} rad/s\n`; changed = true; }
          if ('omega' in result && 'g' in result && !('L' in result)) { result.L = result.g / result.omega**2; explanation += `L = g/œâ¬≤ = ${result.L.toFixed(6)} m\n`; changed = true; }
          if ('omega' in result && 'L' in result && !('g' in result)) { result.g = result.L * result.omega**2; explanation += `g = L œâ¬≤ = ${result.g.toFixed(6)} m/s¬≤\n`; changed = true; }
        }

        // ---------- ‡∏Ñ‡πà‡∏≤‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ----------
        if ('omega' in result && 'A' in result && !('Vmax' in result)) { result.Vmax = result.omega * result.A; explanation += `Vmax = œâA = ${result.Vmax.toFixed(6)} m/s\n`; changed = true; }
        if ('Vmax' in result && 'omega' in result && !('A' in result)) { result.A = result.Vmax / result.omega; explanation += `A = Vmax/œâ = ${result.A.toFixed(6)} m\n`; changed = true; }
        if ('omega' in result && 'A' in result && !('a_max' in result)) { result.a_max = result.omega**2 * result.A; explanation += `a_max = œâ¬≤A = ${result.a_max.toFixed(6)} m/s¬≤\n`; changed = true; }
        if ('a_max' in result && 'omega' in result && !('A' in result)) { result.A = result.a_max / result.omega**2; explanation += `A = a_max/œâ¬≤ = ${result.A.toFixed(6)} m\n`; changed = true; }

        if ('m' in result && 'omega' in result && 'A' in result && !('E' in result)) { result.E = 0.5 * result.m * result.omega**2 * result.A**2; explanation += `E = ¬Ω m œâ¬≤ A¬≤ = ${result.E.toFixed(6)} J\n`; changed = true; }
        if ('m' in result && 'omega' in result && 'x' in result && !('PE' in result)) { result.PE = 0.5 * result.m * result.omega**2 * result.x**2; explanation += `PE = ¬Ω m œâ¬≤ x¬≤ = ${result.PE.toFixed(6)} J\n`; changed = true; }
        if ('m' in result && 'v' in result && !('KE' in result)) { result.KE = 0.5 * result.m * result.v**2; explanation += `KE = ¬Ω m v¬≤ = ${result.KE.toFixed(6)} J\n`; changed = true; }
        if ('KE' in result && 'PE' in result && !('E' in result)) { result.E = result.KE + result.PE; explanation += `E = KE + PE = ${result.E.toFixed(6)} J\n`; changed = true; }

        if ('omega' in result && 'x' in result && !('a' in result)) { result.a = -result.omega**2 * result.x; explanation += `a = -œâ¬≤x = ${result.a.toFixed(6)} m/s¬≤\n`; changed = true; }
        if ('m' in result && 'omega' in result && 'x' in result && !('sigmaF' in result)) { result.sigmaF = -result.m * result.omega**2 * result.x; explanation += `F = -m œâ¬≤ x = ${result.sigmaF.toFixed(6)} N\n`; changed = true; }

        // v ‡∏à‡∏≤‡∏Å‡∏û‡∏•‡∏±‡∏á‡∏á‡∏≤‡∏ô (magnitude)
        if ('omega' in result && 'A' in result && 'x' in result && !('v' in result)) {
          const vMag = result.omega * Math.sqrt(Math.max(0, result.A**2 - result.x**2));
          result.v = vMag; // magnitude ‡∏Å‡πà‡∏≠‡∏ô ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡πÄ‡∏ü‡∏™‡∏à‡∏∞‡∏ó‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏°‡∏≤‡∏¢
          explanation += `|v| = œâ ‚àö(A¬≤‚àíx¬≤) = ${vMag.toFixed(6)} m/s\n`;
          changed = true;
        }

        // ‡∏à‡∏≤‡∏Å‡πÄ‡∏ß‡∏•‡∏≤ + ‡πÄ‡∏ü‡∏™
        if ('omega' in result && 't' in result && 'phi' in result && !('Phi' in result)) { result.Phi = result.omega * result.t + result.phi; explanation += `Œ¶ = œât + œÜ = ${result.Phi.toFixed(6)} rad\n`; changed = true; }
        if ('A' in result && 'Phi' in result && !('x' in result)) { result.x = result.A * Math.cos(result.Phi); explanation += `x = A cos(Œ¶) = ${result.x.toFixed(6)} m\n`; changed = true; }
        if ('omega' in result && 'A' in result && 'Phi' in result && !('v' in result)) { result.v = -result.omega * result.A * Math.sin(result.Phi); explanation += `v = -œâ A sin(Œ¶) = ${result.v.toFixed(6)} m/s\n`; changed = true; }
        if ('omega' in result && 'A' in result && 'Phi' in result && !('a' in result)) { result.a = -result.omega**2 * result.A * Math.cos(result.Phi); explanation += `a = -œâ¬≤ A cos(Œ¶) = ${result.a.toFixed(6)} m/s¬≤\n`; changed = true; }
      }

      return { result, explanation };
    }

    // ====================== ‡∏õ‡∏∏‡πà‡∏°‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ======================
    function calculate() {
      const mode = document.getElementById('mode').value;
      const system = document.getElementById('system').value;
      const numStates = mode === 'single' ? 1 : 2;

      let results = [];
      let explanations = [];

      for (let i = 1; i <= numStates; i++) {
        let inputs = {};
        allVars.forEach(k => {
          const el = document.getElementById(`state${i}_${k}`);
          if (el && el.value.trim() !== '') inputs[k] = parseFloat(el.value);
        });

        const { result, explanation } = calculateState(inputs, system);
        results.push(result);
        explanations.push(explanation);
      }

      // ====================== ‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏• ======================
      let html = `<h3>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå ‚Äî ${system === 'spring' ? '‡∏™‡∏õ‡∏£‡∏¥‡∏á' : '‡∏•‡∏π‡∏Å‡∏ï‡∏∏‡πâ‡∏°'} (${mode === 'single' ? '‡∏™‡∏†‡∏≤‡∏ß‡∏∞‡πÄ‡∏î‡∏µ‡∏¢‡∏ß' : '‡∏´‡∏•‡∏≤‡∏¢‡∏™‡∏†‡∏≤‡∏ß‡∏∞'})</h3>`;

      results.forEach((res, idx) => {
        html += `<h4 style="color:#1677ff;">‚úî ‡∏™‡∏†‡∏≤‡∏ß‡∏∞‡∏ó‡∏µ‡πà ${idx + 1}</h4>`;
        html += '<table><tr>';
        allVars.forEach(k => html += `<th>${varLabels[k]}</th>`);
        html += '</tr><tr>';
        allVars.forEach(k => {
          const val = res[k];
          html += `<td>${val !== undefined && !isNaN(val) ? val.toFixed(4) : ''}</td>`;
        });
        html += '</tr></table>';
        html += `<pre>${explanations[idx] || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°'}</pre><br>`;
      });

      // ---------- ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô (‡πÄ‡∏â‡∏û‡∏≤‡∏∞ multi mode) ----------
      if (mode === 'multi') {
        html += '<h4 style="color:#d4380d;">üåü ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏∏‡∏Å‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ (‡∏™‡∏†‡∏≤‡∏ß‡∏∞ 2 √∑ ‡∏™‡∏†‡∏≤‡∏ß‡∏∞ 1)</h4>';
        html += '<table class="ratio-table"><tr><th>‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£</th><th>‡∏Ñ‡πà‡∏≤ ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô (2/1)</th></tr>';
        allVars.forEach(k => {
          const v1 = results[0][k];
          const v2 = results[1][k];
          if (v1 && v2 && v1 !== 0) {
            const ratio = v2 / v1;
            if (isFinite(ratio)) {
              html += `<tr><td>${varLabels[k]}</td><td>${ratio.toFixed(4)}</td></tr>`;
            }
          }
        });
        html += '</table>';

        // ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏§‡∏©‡∏é‡∏µ
        let ratioExp = '\n‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏§‡∏©‡∏é‡∏µ‡∏à‡∏≤‡∏Å‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå‡∏´‡∏•‡∏±‡∏Å:\n';
        if (system === 'spring' && results[0].m && results[0].k && results[1].m && results[1].k) {
          const r_m = results[1].m / results[0].m;
          const r_k = results[1].k / results[0].k;
          const omegaRatioTheo = Math.sqrt(r_k / r_m);
          const TRatioTheo = Math.sqrt(r_m / r_k);
          ratioExp += `m‚ÇÇ/m‚ÇÅ = ${r_m.toFixed(4)}\n`;
          ratioExp += `k‚ÇÇ/k‚ÇÅ = ${r_k.toFixed(4)}\n`;
          ratioExp += `œâ‚ÇÇ/œâ‚ÇÅ = ‚àö(k‚ÇÇ/k‚ÇÅ √∑ m‚ÇÇ/m‚ÇÅ) = ${omegaRatioTheo.toFixed(4)}\n`;
          ratioExp += `T‚ÇÇ/T‚ÇÅ = ‚àö(m‚ÇÇ/m‚ÇÅ √∑ k‚ÇÇ/k‚ÇÅ) = ${TRatioTheo.toFixed(4)}\n`;
        } else if (system === 'pendulum' && results[0].L && results[0].g && results[1].L && results[1].g) {
          const r_L = results[1].L / results[0].L;
          const r_g = results[1].g / results[0].g;
          const omegaRatioTheo = Math.sqrt(r_g / r_L);
          const TRatioTheo = Math.sqrt(r_L / r_g);
          ratioExp += `L‚ÇÇ/L‚ÇÅ = ${r_L.toFixed(4)}\n`;
          ratioExp += `g‚ÇÇ/g‚ÇÅ = ${r_g.toFixed(4)}\n`;
          ratioExp += `œâ‚ÇÇ/œâ‚ÇÅ = ‚àö(g‚ÇÇ/g‚ÇÅ √∑ L‚ÇÇ/L‚ÇÅ) = ${omegaRatioTheo.toFixed(4)}\n`;
          ratioExp += `T‚ÇÇ/T‚ÇÅ = ‚àö(L‚ÇÇ/L‚ÇÅ √∑ g‚ÇÇ/g‚ÇÅ) = ${TRatioTheo.toFixed(4)}\n`;
        }
        html += `<pre style="background:#fff3cd;">${ratioExp}</pre>`;
      }

      document.getElementById('result').innerHTML = html;
      document.getElementById('result').style.display = 'block';
    }

    function clearAll() {
      document.querySelectorAll('input[type="text"]').forEach(i => i.value = '');
      document.getElementById('result').style.display = 'none';
    }

    function showHelp() { document.getElementById('helpModal').style.display = 'block'; }
    function closeHelp() { document.getElementById('helpModal').style.display = 'none'; }

    // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
    updateMode(); // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ä‡πà‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏¢
    updateVisibility();
  </script>
</body>
</html>
